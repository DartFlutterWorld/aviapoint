# Логика полей is_published и is_active

## Текущая логика

### `is_published` (пользовательский флаг)
- **Назначение**: Пользователь решил опубликовать объявление или оставить как черновик
- **Устанавливается**: Пользователем при создании/публикации/снятии с публикации
- **Значения**:
  - `true` = объявление опубликовано пользователем
  - `false` = черновик или снято с публикации

### `is_active` (системный флаг)
- **Назначение**: Система автоматически деактивирует истекшие объявления
- **Устанавливается**: Автоматически системой при проверке срока публикации
- **Значения**:
  - `true` = объявление активно (срок не истек)
  - `false` = автоматически деактивировано системой (истек срок `published_until`)

## Проблема

В запросах оба поля всегда проверяются вместе:
```sql
WHERE pm.is_active = true AND pm.is_published = true AND (pm.published_until IS NULL OR pm.published_until >= NOW())
```

Это избыточно, так как:
- Если `published_until < NOW()`, то `is_active` автоматически становится `false`
- Если `is_published = false`, объявление все равно не показывается

## Предложение по упрощению

### Вариант 1: Убрать `is_active`, использовать только `is_published` + проверка `published_until`
```sql
WHERE pm.is_published = true AND (pm.published_until IS NULL OR pm.published_until >= NOW())
```

### Вариант 2: Оставить оба, но упростить логику
- `is_published` - пользователь хочет опубликовать
- `is_active` - только для автоматической деактивации истекших (можно убрать, проверяя `published_until` напрямую)

## Рекомендация

**Использовать только `is_published` + проверку `published_until`**, так как:
1. `is_active` дублирует проверку `published_until >= NOW()`
2. Упрощает логику и уменьшает количество полей
3. Меньше вероятность рассинхронизации данных

Если нужно сохранить `is_active` для производительности (индекс), можно оставить его как вычисляемое поле или триггер.
